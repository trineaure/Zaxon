USE Zaxon2
GO

CREATE TRIGGER DeleteReservation ON Reservation
INSTEAD OF DELETE
as
DECLARE @resID int
SELECT @resID = Reservation_number FROM DELETED
DECLARE @memberid int
SELECT @memberid = Membership_number FROM DELETED
BEGIN
DELETE FROM Reservation_treatment 
WHERE Reservation_number in (SELECT Reservation.Reservation_number FROM Reservation WHERE Reservation.Membership_number = @memberid)
DELETE FROM Reservation WHERE Membership_number =  @memberid
print @resID
end


CREATE TRIGGER DeleteMember ON Member
INSTEAD OF DELETE
as
DECLARE @memberid int
SELECT @memberid = Membership_number FROM DELETED
BEGIN
PRINT @memberid
DELETE FROM Reservation WHERE Membership_number = @memberid
DELETE FROM Member WHERE Membership_number = @memberid
end

-- NEDENFOR BRUKES IKKE DA DET IKKE GÅR ANN Å HA TO TRIGGERE AV SAMME TYPE I SAMME TABLE

USE Zaxon2
GO

CREATE TRIGGER DeleteReservationE ON Reservation
INSTEAD OF DELETE
as
DECLARE @resID int
SELECT @resID = Reservation_number FROM DELETED
DECLARE @employeeID int
SELECT @employeeID = EmployeeID FROM DELETED
BEGIN
DELETE FROM Reservation_treatment 
WHERE Reservation_number in (SELECT Reservation.Reservation_number FROM Reservation WHERE Reservation.EmployeeID = @employeeID)
DELETE FROM Reservation WHERE EmployeeID =  @employeeID
print @resID
end


CREATE TRIGGER DeleteEmployee ON Employee
INSTEAD OF DELETE
as
DECLARE @employeeID int
SELECT @employeeID = EmployeeID FROM DELETED
BEGIN
PRINT @employeeID
DELETE FROM Reservation WHERE EmployeeID = @employeeID
DELETE FROM Member WHERE EmployeeID = @employeeID
end

